{
  "behavior_name": "chat",
  "description": "Character chat behavior - builds prompts for character interactions",
  "common_behavior_rules": {
    "role_boundaries": {
      "not_game_master": "The character agent does NOT control the game world, other characters, or plot events",
      "not_controlling_other_characters": "Never speak for, control, or narrate actions of other characters",
      "not_advancing_plot": "Do NOT add, assume, or extend plot details. Only respond to what is explicitly provided",
      "not_narrating_scenery": "Do NOT describe scenery, environment, or world elements unless explicitly asked"
    },
    "response_guidelines": {
      "first_person_perspective": "Write in first person (\"I...\" not \"He...\" or \"The character...\")",
      "character_perspective_only": "Focus on what the character says, thinks, feels, or does - never on what others do",
      "stay_in_character": "Every response must sound like something the character would say, think, or describe",
      "ask_for_clarification": "If plot context or scene details are unclear, ask for clarification before responding"
    },
    "content_guidelines": {
      "concise_responses": "Keep responses concise (2-3 sentences, one short paragraph max for actions)",
      "no_filler": "Avoid filler, casual banter, or unnecessary elaboration",
      "no_inner_essays": "Avoid long inner monologues or emotion dumps",
      "no_contradiction": "Do NOT contradict established canon or character sheet data"
    },
    "plot_context": {
      "understand_context": "Always ensure you understand where the character is in the plot and what the context of the scene is before responding",
      "confirm_understanding": "When plot is entered, repeat it in your words so user can confirm correct understanding",
      "no_assumptions": "Do NOT add, assume, or extend any plot details beyond what is provided"
    }
  },
  "usage_documentation": {
    "identities": {
      "description": "Characters may have multiple identities (costumed identity and secret identity). The active identity determines how the character responds.",
      "costumed_identity": {
        "description": "The superhero/costumed identity",
        "usage": "When identity is set to costumed, use that identity's characteristics and behaviors. Shared core personality traits apply to all identities. Identity-specific characteristics override or supplement shared traits."
      },
      "secret_identity": {
        "description": "The civilian/secret identity (optional)",
        "usage": "When identity is set to secret, use that identity's characteristics and behaviors. Shared core personality traits apply to all identities. Identity-specific characteristics override or supplement shared traits."
      },
      "how_identities_work": "When identity is set, use that identity's characteristics and behaviors. Shared core personality traits apply to all identities. Identity-specific characteristics override or supplement shared traits."
    },
    "response_modes": {
      "description": "Character responses are combinations of combat mode and output type.",
      "combat_mode": {
        "description": "Combat mode: 'combat' or 'non-combat'",
        "when_to_use": "Use 'combat' mode when the character is in a fight, battle, or combat situation. Use 'non-combat' mode for conversations, exploration, social interactions, or other non-combat scenarios."
      },
      "output_type": {
        "description": "Output type: 'speak', 'act', or 'both'",
        "speak": "Character speaks (dialogue only)",
        "act": "Character acts (action description only)",
        "both": "Character both speaks and acts (use both speak and act examples together)"
      },
      "resulting_modes": "This results in 4 base interaction modes (speak/act × combat/non-combat). When output_type is 'both', use both speak and act examples together."
    },
    "context_detection": {
      "description": "Combat and non-combat modes can be automatically detected from keywords in user input when no explicit mode parameter is provided.",
      "when_detection_happens": "If no explicit mode parameter is provided, the system automatically detects mode from keywords in user input. Explicit mode parameters always take precedence over context detection.",
      "default_combat_keywords": [
        "hit", "attack", "fight", "strike", "punch", "kick", "dodge", "block", "counter",
        "combat", "battle", "enemy", "alien", "opponent", "weapon", "laser", "blast",
        "miss", "damage", "defend", "evade"
      ],
      "default_non_combat_keywords": [
        "boardroom", "meeting", "conversation", "walking", "talking", "discussion"
      ]
    },
    "context_folder_system": {
      "description": "Every character has a context folder that contains documents with relevant facts, information, plot details, and continuity information.",
      "purpose": "Store any documents relevant to the character (plot summaries, episode summaries, world information, canon documents, etc.). When building prompts, the system automatically searches context folder for relevant facts and information based on user input.",
      "canon_source_hierarchy": {
        "description": "The system uses a canonical source hierarchy to determine which information takes precedence when conflicts occur:",
        "primary_source": {
          "name": "Episode Documents",
          "description": "Approved episode summaries represent actualized canon events and always override prior drafts or implied material. Episodes contain all episodic continuity."
        },
        "secondary_source": {
          "name": "Plot Document Background",
          "description": "Background and intended arcs provide core narrative foundation, institutional structure, character motives, and timeline foundations. Use for supporting details when episodes don't specify."
        },
        "tertiary_source": {
          "name": "Other Context Files",
          "description": "World information, canon documents, public framing documents, environmental background. Use for external tone, environmental framing, or supporting details."
        },
        "conflict_resolution": "Episodes always override plot background when conflicts occur. Episodes represent actualized canon, plot background represents intended arcs. Never contradict episode continuity - episode events always take precedence."
      },
      "context_parameter": {
        "description": "The MCP tool accepts an optional 'context_files' parameter to limit which context files are searched",
        "parameter_type": "Array of strings (file names)",
        "when_to_use": "Use this parameter when you want to restrict the context search to specific files. For example, if you know the relevant information is in 'plot-background.md' and 'npc-notes.md', you can specify those files to speed up the search and ensure only relevant context is included.",
        "example": "context_files: ['plot-background.md', 'npc-notes.md']",
        "if_not_provided": "If context_files parameter is not provided (or is null/empty), the system automatically searches all context files in the character's context folder for relevant information based on user input keywords. The system uses the canon source hierarchy (episodes → plot background → other context) to prioritize information.",
        "file_names": "The file names should match files in the character's context folder. You can use partial matches - if a context file name contains any of the strings in the array, it will be included."
      }
    }
  },
  "mcp_tool": {
    "name": "character_chat_build_prompt",
    "description": "Build prompt for character chat interaction from template and character profile",
    "parameters": {
      "character_name": {
        "type": "string",
        "required": true,
        "description": "Character name"
      },
      "user_input": {
        "type": "string",
        "required": true,
        "description": "User input/message to the character"
      },
      "mode": {
        "type": "string",
        "required": false,
        "enum": ["combat", "non-combat"],
        "description": "Mode: 'combat' or 'non-combat'"
      },
      "output_type": {
        "type": "string",
        "required": false,
        "enum": ["speak", "act", "both"],
        "description": "Output type: 'speak', 'act', or 'both'"
      },
      "identity": {
        "type": "string",
        "required": false,
        "description": "Identity to use: 'costumed', 'secret', or other identity name"
      },
      "context_files": {
        "type": "array",
        "required": false,
        "items": {
          "type": "string"
        },
        "description": "Optional: Array of context file names to limit the search to. If provided, only these files (or files containing these strings) will be searched for relevant context. If not provided, all context files are automatically searched based on user input keywords. Example: ['plot-background.md', 'npc-notes.md']"
      }
    }
  }
}

