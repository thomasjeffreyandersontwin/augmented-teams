---
description: Sync behaviors from features to .cursor/ deployment
globs:
  - "**/*-rule.mdc"
  - "**/*-cmd.md"
  - "**/*-runner.py"
  - "**/behavior.json"
  - "**/.cursor/rules/**"
  - "**/.cursor/commands/**"
---

**When** a behavior is added or updated in a feature's `cursor/` folder,
**then** sync it to the corresponding location in `.cursor/`.

**Always:**
* Preserve file structure (`rules`, `commands`, `functions`, `mcp`).
* Merge MCP configs (`*-mcp.json`) if they already exist.
* Merge `tasks.json` files from `behaviors/*/.vscode/tasks.json` into root `.vscode/tasks.json` (combine tasks from all features, avoid duplicate labels).
* Overwrite only if the source is newer.
* Log synced and merged files.
* **Restart any watcher processes** if their Python files were synced (detects `*_watch()` functions and restarts them to pick up code changes).

**Never:**
* Edit `.cursor/` directly — it's generated.
* Sync behaviors marked as "draft" or "experimental."
* Sync files in `docs/` directories — those are documentation only, not active behaviors.

**Executing Commands:**
* `\behavior-sync` — Syncs all the behaviors from features to .cursor/ folders. Call after modifying files in `behaviors/*/cursor/` directories, or use watch mode for automatic syncing. Automatically restarts watcher processes if their Python files were synced.