FUNCTIONAL PURPOSE: Make AI behavior management self-maintaining through structured validation, deployment, and consistency checking

BEHAVIOR
	Reusable instruction set defining how AI responds to specific situations
	Complete definition consists of structure, validation, creation, deployment, and discovery
	
	Structure
		What a behavior consists of and how its parts relate
		Defines complete anatomy of a behavior definition
		
		RELATIONSHIPS:
			Feature has many Behaviors
			Behavior has one Rule
			Behavior has one or more Commands
			Behavior has zero or one Runner
			Rule executed by one or more Commands (e.g., validate-cmd, fix-cmd, create-cmd)
			Command invokes zero or one Runner
			Command contains many Steps
			Runner Step (in Command) relates to one Runner function/method
		
		Rule (.mdc file)
			Triggering conditions and guidelines
			Starts with "When <event> condition, then <action>"
			References commands that execute it
			References tools used by behavior
			
			RELATIONSHIPS:
				One Rule per Behavior
				Executed by one or more Commands
		
		Command (.md file)
			Executable steps implementing a rule
			Bridges abstract rules (what) and implementation (how)
			Specifies performer for each step (User, Code, AI Agent, MCP Tool)
			
			Properties:
				Purpose, Usage, Rule, Runner, Steps
			
			RELATIONSHIPS:
				One or more Commands per Behavior (e.g., validate, fix, create)
				Executes one Rule
				Invokes zero or one Runner
				Contains many Steps
		
		Runner (.py file)
			Python implementation that automates behavior execution
			Stays in feature directory (behaviors/<feature>/)
			Contains guard function to prevent direct execution
			
			Types:
				Feature-level: <feature>-runner.py (consolidated)
				Behavior-level: <feature>-<behavior>-runner.py (complex)
			
			RELATIONSHIPS:
				Zero or one Runner per Behavior
				Invoked by one or more Commands
				Contains many functions/methods
				Each Runner function/method corresponds to one or more Command Runner Steps
		
		Relationships
			How behavior components link together
			Rules reference commands, commands reference runners
			Commands include Steps section with performers
			Related files share consistent prefixes
			
			Content Analysis
				Parses behavior file contents
				Extracts sections, relationships, and metadata
		
		Naming
			Standardized file naming pattern for discoverability
			Pattern: <feature>-<behavior-name>-<type>.<ext>
			
			Rules: <feature>-<behavior-name>-rule.mdc (no verb suffix)
			Commands: <feature>-<behavior-name>-cmd.md OR <feature>-<behavior-name>-<verb>-cmd.md
			Runners: <feature>-runner.py (consolidated) OR <feature>-<behavior>-runner.py
			MCP: <feature>-<tool-name>-mcp.json
			
			Pattern Matching
				Regular expressions for file naming validation
				Pattern: ^([a-z0-9\-]+)-([a-z0-9\-]+)(?:-([a-z0-9\-]+))?-(rule|cmd|runner|mcp)\.(mdc|md|py|json)$
	
	Validation
		Checks structure compliance
		Reports violations and missing sections
		Ensures naming conventions followed
		Verifies relationships properly linked
	
	Creation
		Scaffolds new behavior with all required files
		Generates rule with When/then structure
		Generates command with relationship sections
		Creates proper naming structure
	
	Repair
		Fixes structure issues automatically
		Creates missing command files
		Adds missing relationship sections
		Adds documentation headers
	
	Deployment
		Keeps behaviors synchronized from development to active use
		Copies files from features to .cursor/ deployment locations
		
		Sync Logic:
			Finds directories with behavior.json (deployed: true)
			Routes by extension to correct destinations:
				.mdc files → .cursor/rules/
				.md files → .cursor/commands/
				.json MCP files → .cursor/mcp/ (merged if exists)
				.json task files → .vscode/tasks.json (merged)
				.py files → NOT synced (stay in feature directory)
			Checks for draft/experimental markers
			Overwrites only if source newer (unless --force)
			Merges MCP and task configurations
			Restarts watcher processes if Python files synced
		
		Exclusion:
			behavior.json files
			Runner files (*-runner.py)
			Index files (*-index.json)
			Documentation directories (docs/)
			Draft/experimental files
		
		Configuration Discovery
			Finds behavior.json files with deployed: true
			Uses iterdir() for direct scanning
			Parses JSON configuration
			
			Functions:
				find_deployed_behaviors()
				find_all_behavior_jsons()
				get_behavior_feature_name()
		
		Watcher Restart
			Detects watcher processes and restarts after sync
			Looks for *_watch() functions in synced Python files
	
	Indexing
		Maintains searchable indexes of all behaviors
		Tracks what behaviors exist and where
		
		Index Structure
			Consolidated view of all deployed behaviors
			
			Global Index (.cursor/behavior-index.json):
				Last updated timestamp
				Total behaviors count
				Features count
				Behavior entries array
			
			Entry Properties:
				Feature name
				File name
				File type (.mdc, .md, .py, .json)
				Full file path
				Modified timestamp
		
		Discovery Process
			Scans features and updates indexes
			Uses iterdir() for direct directory scanning
			Filters by extension and exclusion patterns
			Records modification timestamps for freshness
	
	Consistency Analysis
		Analyzes behaviors for overlaps and contradictions
		Compares behavior definitions for semantic conflicts
		
		Semantic Analysis
			Uses OpenAI function calling for intelligent comparison
			
			OpenAI Function Calling
				AI-powered semantic analysis using structured output
				Loads OPENAI_API_KEY from .env
				Defines function schemas for analysis
				Returns structured results
			
			Analysis Types:
				Overlaps: Similar purpose, different approach
				Contradictions: Opposite guidance, same context
				Inconsistencies: Naming, tone, or scope mismatch
			
			Analysis Schema
				Function calling schema for structured output
				Properties: Overlaps array, Contradictions array, Summary string
	
	Specialized Behaviors
		Framework-specific variations of base behaviors
		Extends base behavior with hierarchical patterns
		
		Hierarchical Pattern
			Base rule: Common behavior definition
			Specialized rules: Framework/language variations
			Reference files: Examples
			Declaration: isSpecialized: true in behavior.json
			
			Example: BDD testing has base rule + Jest/Mamba specializations
	
	Pattern-Based Suggestion
		Detects repetitive patterns and suggests new behaviors
		Identifies automation opportunities
		
		Pattern Detector
			Analyzes conversation patterns for repetitive tasks
			Suggests creating reusable behavior definitions
			
			Conversation Analysis
				Monitors conversation patterns for repetition

FEATURE
	Collection of tightly-knit, strongly related behaviors
	Grouping mechanism for related behavior definitions
	
	RELATIONSHIPS:
		One Feature contains many Behaviors
		One Feature marked by one behavior.json
		One Feature contains one outline.md
	
	Properties:
		Name: Overarching purpose
		Deployed: true/false activation flag
		Description: Brief purpose statement
	
	Marked with behavior.json configuration file
	Contains outline.md describing purpose and behaviors

SYSTEM INFRASTRUCTURE
	Technical systems used across multiple domains
	
	File System Operations
		Reading, writing, and organizing behavior files
		Path resolution and directory scanning
		Timestamp tracking
	
	Runner Guard
		Prevents direct runner execution, enforces command workflow
		Checks for --from-command flag
		Displays helpful message directing to slash command
		Bypass with --no-guard for testing
		
		Function: require_command_invocation(command_name)
