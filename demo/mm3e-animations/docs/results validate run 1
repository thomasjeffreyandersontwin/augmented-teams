============================================================
BDD TEST VALIDATION REPORT
============================================================
File: demo/mm3e-animations/mm3e-effects-section.test.mjs
Framework: Jest
Test Blocks: 94
Static Issues: 0
============================================================

SECTION 1: Business Readable Language
============================================================

❌ Line 34: describe('MM3E Effects Section', ...)
   Violation: Uses technical module/file name instead of domain concept
   Fix: Use "the MM3E animation effects system" or "animation effects for powers"
   Reference: bdd-jest-behavior-rule.mdc § 1 - "Prefer domain terms over technical jargon"

❌ Line 159: describe('GameHelper', ...)
   Violation: Uses class name without article, missing natural connection
   Fix: Use "a game helper" or "game state management"
   Reference: bdd-jest-behavior-rule.mdc § 1 - "Use nouns for describe (concepts, states)"
   
   Example from rule:
   ✅ DO: describe('a ranged damage power', () => {})
   ❌ DON'T: describe('Attack', () => {})

❌ Line 162: describe('Token Selection Methods', ...)
   Violation: Uses "Methods" (technical jargon) instead of behavior/concept
   Fix: Use "when selecting tokens" or "token selection behavior"
   Reference: bdd-jest-behavior-rule.mdc § 1 - "Prefer domain terms over technical jargon"

❌ Line 195: describe('Target Selection Methods', ...)
   Violation: Same as above - uses technical term "Methods"
   Fix: Use "when targeting tokens" or "target selection behavior"

❌ Line 227: describe('Template Methods', ...)
   Violation: Same as above - uses technical term "Methods"
   Fix: Use "when working with templates" or "template management"

❌ Line 255: describe('Utility Methods', ...)
   Violation: Uses technical term "Methods"
   Fix: Use "utility behaviors" or describe specific utilities

❌ Line 278: describe('PowerItem', ...)
   Violation: Uses class name without article
   Fix: Use "a power item" or "a power"
   Reference: bdd-jest-behavior-rule.mdc § 1 - "Use nouns for describe"

❌ Line 281: describe('Constructor and Initialization', ...)
   Violation: Uses technical implementation terms
   Fix: Use "that is created" or "when created"
   Reference: bdd-jest-behavior-rule.mdc § 1 - "Use plain behavioral language"

❌ Line 310: describe('Token and Attack Properties', ...)
   Violation: Uses technical term "Properties"
   Fix: Use "when associated with a token and attack"

============================================================
SECTION 2: Comprehensive and Brief
============================================================

❌ Line 164-175: it('should return the first controlled token when accessing selected', ...)
   Violation: Tests mock setup instead of actual GameHelper behavior
   Issue: Code is commented out (line 171), only tests mockCanvas not GameHelper
   Fix: Import and test actual GameHelper.selected getter
   Reference: bdd-jest-behavior-rule.mdc § 2 - "Test observable behavior, not hidden internals"
   
   Example from rule:
   ✅ DO: expect(attack.isRanged).toBe(true);
   ❌ DON'T: expect(form._internal_flag).toBe(true);

❌ Line 177-190: it('should return all controlled tokens when accessing selecteds', ...)
   Violation: Tests mock data structure instead of GameHelper behavior
   Issue: Tests mockCanvas.tokens.controlled directly, not the actual class
   Fix: Test GameHelper.selecteds or GameHelper.selectedTokens

❌ Line 283-292: it('should initialize with a document item when provided', ...)
   Violation: Tests mock setup, not actual PowerItem initialization
   Issue: PowerItem instantiation is commented out, only checks mock exists
   Fix: Uncomment PowerItem creation and test actual properties
   Reference: bdd-jest-behavior-rule.mdc § 2 - "Don't mistake helpers or glue code for test targets"

❌ Line 294-303: it('should initialize with a direct item when provided', ...)
   Violation: Same as above - tests mock existence not behavior
   Fix: Create PowerItem and verify it correctly wraps the item

❌ Line 305-315: it('should initialize with undefined when no input provided', ...)
   Violation: Tests undefined variable, not PowerItem behavior
   Fix: Create PowerItem with no args and test its default state

⚠️  Multiple tests throughout file
   Warning: Many tests have actual class instantiation commented out
   Impact: Tests validate mock structure but not actual behavior
   Suggestion: Uncomment PowerItem/GameHelper instantiations or import classes

============================================================
SECTION 3: Balance Context Sharing with Localization
============================================================

✅ Lines 100-153: Test helper factories
   Strength: Good use of createMockToken, createMockPowerItem, createMockAttack
   Follows: "Provide expected data via helper factories/builders"

✅ Lines 46-97: beforeEach setup
   Strength: Centralized mock setup with proper reset in afterEach
   Follows: "Centralize setup/teardown logic" and "Clear state after each run"

✅ Helper placement
   Strength: Helpers defined close to tests (lines 100-153)
   Follows: "Keep setup/helper code as close to your test code as you can"

============================================================
SECTION 4: Cover All Layers of the System
============================================================

❌ Overall test organization
   Violation: Tests organized by class (GameHelper, PowerItem) not by feature/story
   Issue: No narrative flow connecting animation system components
   Fix: Reorganize as "an animation for a ranged power" → test cast/project/effect together
   Reference: bdd-jest-behavior-rule.mdc § 4 - "Organize tests so they tell a story"
   
   Example from rule:
   ✅ DO: describe('an Attack Power', () => {
            describe('whose actor data is being displayed', () => {}); // Front-end
            describe('that is a damage power', () => {}); // Domain
            describe('that has been saved', () => {}); // Data
          });

⚠️  Lines 159-272: GameHelper tests
   Warning: Tests isolated helpers without showing how they support animation features
   Suggestion: Frame as "the animation system when managing game state"

⚠️  Lines 278-646: PowerItem tests
   Warning: Tests PowerItem in isolation without showing its role in animations
   Suggestion: Frame as "a power when being animated" or "an animated power"

============================================================
SECTION 5: Unit Tests the Front-End
============================================================

✅ Not applicable
   Note: This code is business logic/domain layer, not front-end rendering
   Front-end rules don't apply here

============================================================
VALIDATION SUMMARY
============================================================
❌ 17 violations found (must fix)
⚠️  4 warnings (should improve)
✅ 4 principles followed correctly

Main Issues:
1. Describe blocks use class names and technical terms instead of domain language
2. Many tests validate mock structure instead of actual class behavior
3. Tests organized by technical structure (classes) not behavioral stories
4. Actual class instantiation is commented out in many tests

Recommended Actions:
1. Rename describe blocks to use domain language (e.g., "a power item" not "PowerItem")
2. Replace technical terms ("Methods", "Properties") with behavioral descriptions
3. Uncomment and test actual class instances, not just mocks
4. Reorganize tests to tell the story of "animating a power" across components

============================================================