{
  "behaviorName": "specification_scenarios",
  "step": "1_knowledge_graph",
  "instructions": [
    "**BUILD STORY GRAPH WITH SCENARIOS**",
    "",
    "**Input:** Existing story-graph.json from exploration stage",
    "",
    "**Output:** Updated story-graph.json with scenarios added to each story",
    "",
    "**Process:**",
    "",
    "1. **Load existing story graph** from project area: docs/stories/story-graph.json",
    "",
    "2. **For each story in the graph:**",
    "   - Review story name, description, and acceptance criteria",
    "   - Identify common setup steps that apply across multiple scenarios (if 3+ scenarios share setup, move to Background)",
    "   - Generate scenarios covering:",
    "     * **happy_path**: Normal, expected user flow",
    "     * **edge_case**: Boundary conditions, unusual but valid inputs",
    "     * **error_case**: Invalid inputs, error conditions, validation failures",
    "",
    "3. **Structure each scenario:**",
    "   ```json",
    "   {",
    "     \"name\": \"Descriptive scenario name\",",
    "     \"type\": \"happy_path|edge_case|error_case\",",
    "     \"background\": [",
    "       \"Given <common_setup_step>\",",
    "       \"And <another_common_setup>\"",
    "     ],",
    "     \"steps\": [",
    "       \"Given <scenario_specific_state>\",",
    "       \"When <user_action_or_system_event>\",",
    "       \"Then <expected_outcome>\"",
    "     ]",
    "   }",
    "   ```",
    "",
    "4. **Use Gherkin best practices:**",
    "   - Use plain English (no variables, test data, or code)",
    "   - Be specific and concrete",
    "   - Focus on user behavior and outcomes",
    "   - Use 'Given' for state/setup, 'When' for action/event, 'Then' for expected outcome",
    "   - Use 'And' to continue from previous step type",
    "",
    "5. **Save updated story graph** to project area: docs/stories/story-graph.json",
    "",
    "**Template:** story-graph-outline-scenarios.json",
    "",
    "**Validation:**",
    "- Each story has at least 1 happy_path scenario",
    "- Edge cases and error cases are included where relevant",
    "- Background steps are only used when shared by 3+ scenarios",
    "- All steps use proper Gherkin format (Given/When/Then/And)"
  ]
}


