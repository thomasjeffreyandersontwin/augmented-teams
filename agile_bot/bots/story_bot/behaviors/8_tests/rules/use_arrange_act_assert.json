{
  "description": "Use Given-When-Then (Arrange-Act-Assert) structure in tests. Each test should have clear Given (setup), When (action), Then (verify) sections with comments. Keep each section focused and under 5 lines. Extract complex setup into helper functions.",
  "examples": [
    {
      "do": {
        "description": "Clear Given-When-Then structure",
        "content": [
          "def test_agent_initializes_with_base_config(self, workspace_root):",
          "    \"\"\"Agent initializes with base configuration when config exists.\"\"\"",
          "    # Given: Base configuration exists",
          "    config_path = create_base_config(workspace_root, name='story_bot')",
          "    ",
          "    # When: Agent is initialized",
          "    agent = Agent(agent_name='story_bot', workspace_root=workspace_root)",
          "    ",
          "    # Then: Agent has correct configuration path",
          "    assert agent.config_path == config_path",
          "    assert agent.config_path.exists()"
        ]
      },
      "dont": {
        "description": "Missing structure or mixed concerns",
        "content": [
          "# DON'T: No clear sections",
          "def test_agent(self):",
          "    config_path = Path('config.json')",
          "    config_path.write_text('{}')",
          "    agent = Agent('bot')",
          "    assert agent.config_path == config_path",
          "    agent.initialize()",
          "    assert agent.initialized",
          "    # WRONG - no clear Given/When/Then, mixed actions",
          "",
          "# DON'T: Sections too long (over 5 lines)",
          "def test_agent_setup(self):",
          "    # Given - TOO LONG",
          "    workspace = Path('workspace')",
          "    workspace.mkdir()",
          "    config = workspace / 'config.json'",
          "    config.write_text('{\"name\": \"bot\"}')",
          "    data = workspace / 'data'",
          "    data.mkdir()",
          "    # Extract to helper function!"
        ]
      }
    },
    {
      "do": {
        "description": "Extract complex setup to helpers",
        "content": [
          "# Helper function",
          "def create_workspace_with_config(tmp_path, agent_name):",
          "    workspace = tmp_path / 'workspace'",
          "    workspace.mkdir()",
          "    config_path = workspace / 'config.json'",
          "    config_path.write_text(f'{{\"name\": \"{agent_name}\"}}')",
          "    return workspace, config_path",
          "",
          "# Clean test using helper",
          "def test_agent_loads_config(self, tmp_path):",
          "    # Given",
          "    workspace, config_path = create_workspace_with_config(tmp_path, 'story_bot')",
          "    ",
          "    # When",
          "    agent = Agent.from_config(config_path)",
          "    ",
          "    # Then",
          "    assert agent.name == 'story_bot'"
        ]
      },
      "dont": {
        "description": "Inline complex setup in test",
        "content": [
          "def test_agent(self, tmp_path):",
          "    # DON'T: Complex setup inline (should be helper)",
          "    workspace = tmp_path / 'workspace'",
          "    workspace.mkdir()",
          "    agents_dir = workspace / 'agents'",
          "    agents_dir.mkdir()",
          "    base_dir = agents_dir / 'base'",
          "    base_dir.mkdir()",
          "    config = base_dir / 'config.json'",
          "    config.write_text('{\"name\": \"bot\"}')",
          "    # Use helper function instead!"
        ]
      }
    }
  ]
}
