{
  "actionName": "decide_planning_criteria",
  "instructions": [
    "**CRITICAL WORKFLOW ENFORCEMENT - NO EXCEPTIONS:**",
    "",
    "You MUST go through planning AFTER clarification for EVERY behavior. Do NOT skip planning stage. Do NOT make assumptions about whether planning has been done. The user can explicitly tell you to skip, but you must NEVER skip on your own initiative.",
    "",
    "**MANDATORY WORKFLOW RULE:**",
    "- You MUST go through planning AFTER clarification for EVERY behavior",
    "- Do NOT skip planning stage",
    "- Do NOT make assumptions about whether planning has been done",
    "- The user can explicitly tell you to skip, but you must NEVER skip on your own",
    "- Present ALL decision criteria and assumptions, get user selections before proceeding",
    "",
    "**CRITICAL: Previous Clarification and Planning Data:**",
    "The clarification and planning data from previous stages has been loaded and is shown above. You MUST review and reference this data when presenting assumptions and decision criteria. Previous decisions and assumptions inform the current planning session.",
    "",
    "Present the following assumptions and decision criteria to the user and ask for their opinion on key decisions.",
    "",
    "**Typical Assumptions:**",
    "{{assumptions}}  --> load from `{bot}/behaviors/{behavior}/guardrails/planning/typical_assumptions.json`",
    "",
    "**Decision Making Criteria:**",
    "{{decision_criteria}}  --> load from `{bot}/behaviors/{behavior}/guardrails/planning/decision_criteria/` directory",
    "",
    "Present these assumptions and decision criteria from the data files to the user. Ask them to review the assumptions and select their preferred criteria/options for each decision point.",
    "",
    "**MANDATORY STORAGE STEP:** After user confirms decisions, you MUST call `agent_store_planning()` MCP tool with:",
    "   - `decisions_made`: dict mapping decision keys to selected options/values",
    "   - `assumptions_made`: dict mapping assumption keys to assumption content",
    "   - The MCP tool will automatically save these to planning.json under the current behavior's section",
    "   - Example: decisions_made={'drill_down': 'Dig deep on system interactions', 'flow_scope': 'End-to-end user-system behavior'}",
    "",
    "**MANDATORY: PAUSE FOR HUMAN FEEDBACK**",
    "When this action is complete, AI MUST pause and wait for human feedback. When human says 'done' or confirms completion, you MUST proceed to the next step: **build_knowledge** (call the build_knowledge action tool)."
  ],
  "templates": {
    "assumptions_and_criteria": {
      "template": "Planning Assessment:\n\n**Assumptions I will make:**\n{{assumptions_list}}\n\n**Decision Criteria Available:**\n{{decision_criteria_questions}}\n\n**Options for each criterion:**\n{{criteria_options}}\n\nPlease review the assumptions and select your preferred criteria/options.",
      "description": "Used to present assumptions and decision criteria to user"
    },
    "high_level_assessment": {
      "template": "Based on your selections, here's my approach:\n\n**Selected Criteria:**\n{{selected_criteria}}\n\n**High-Level Assessment:**\n{{high_level_assessment}}\n\n**Reasoning:**\n{{reasoning}}\n\nPlease confirm if this approach is correct, or provide feedback for adjustments.",
      "description": "Used to present high-level assessment after user selects criteria"
    }
  }
}


