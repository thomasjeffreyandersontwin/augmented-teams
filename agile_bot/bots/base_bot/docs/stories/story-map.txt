(E) Build Agile Bots
    (E) Generate MCP Tools
        (S) MCP Server Generator --> Generate MCP Bot Server
        and (S) MCP Server Generator --> Generate Behavior Action Tools
        and (S) Deploy MCP BOT Server
        and (S) MCP Server Generator --> Restart MCP Server To Load Code Changes
            (AC) WHEN MCP Server Generator receives Bot Config
            (AC) THEN Generator generates unique MCP Server instance with Unique server name from bot name
            (AC) AND Generated server includes Bot Config reference
            (AC) AND Generated server leverages Specific Bot instantiation code
            (AC) WHEN Generator processes Bot Config
            (AC) THEN Generator creates tool code for each (behavior, action) pair
            (AC) AND Enumerates all behaviors and actions from Bot Config
            (AC) AND For each pair, generates tool code with unique name, trigger words, forwarding logic
            (AC) AND Tool catalog prepared with all generated tool instances
            (AC) WHEN Generation Complete
            (AC) THEN Generator deploys/starts generated MCP Server
            (AC) AND Server initializes in separate thread
            (AC) AND Server registers with MCP Protocol Handler using unique server name
            (AC) AND Server publishes tool catalog to AI Chat
            (AC) AND Each tool entry includes name, description, trigger patterns, parameters
            (AC) WHEN Bot code changes are detected
            (AC) THEN MCP Server clears Python bytecode cache (__pycache__)
            (AC) AND MCP Server restarts to load new code
            (AC) AND Server restarts gracefully without losing state
            (AC) AND Server re-registers with MCP Protocol Handler after restart
    (E) Generate CLI
        (S) MCP Server Generator --> Generate BOT CLI code
        and (S) Human --> Generate Cursor Command Files
            (AC) WHEN MCP Server Generator processes Bot Config
            (AC) THEN Generator creates CLI command wrapper structure for bot invocation
            (AC) AND Generator generates CLI entry point script (e.g., bot_cli.py and bot shell script)
            (AC) AND CLI code includes argument parsing for behavior and action parameters
            (AC) AND CLI code includes help/usage documentation generation
            (AC) AND CLI code supports listing available bots, behaviors, and actions
            (AC) AND Generated CLI code integrates with existing bot instantiation logic
            (AC) AND CLI code follows same routing logic as MCP tools for consistency
            (AC) WHEN Human calls generate_cursor_commands(commands_dir, cli_script_path)
            (AC) THEN CLI creates .cursor/commands/ directory if it doesn't exist
            (AC) AND CLI creates <bot-name>.md command file that invokes CLI with bot name (routes to current behavior/action)
            (AC) AND CLI creates <bot-name>-<behavior>.md command file for each behavior in bot that invokes CLI with bot name and behavior (auto-forwards to current action)
            (AC) AND CLI creates <bot-name>-<behavior>-<action>.md command file for each action in each behavior that invokes CLI with bot name, behavior, and action
            (AC) AND CLI creates <bot-name>-close.md command file that invokes CLI with bot name and --close parameter
            (AC) AND Each command file contains simple wrapper command that calls CLI script
            (AC) AND Bot name, behavior, and action are hardcoded in command files (no parameters needed)
            (AC) AND CLI removes obsolete command files for behaviors/actions that no longer exist in bot
            (AC) AND CLI returns dict mapping command names (e.g., story_bot, story_bot-exploration, story_bot-exploration-gather_context, story_bot-close) to file paths

(E) Invoke MCP Bot Server
    (E) Init Project
        (S) Human --> Shares Context and Project Location
        and (S) Human --> Drops Behavior Folder in Chat w/ relevant Bot Config
    or
        (S) Bot Behavior --> Initialize Project Location
        and (S) Bot-Behavior --> Store Context Files
        and (S) Bot --> Intercepts Tool Call With Project Check
        and (S) Bot --> Guards Prevent Writes Without Project
        and (S) Move to Project
        and (S) Stores Activity for Initialize Project Action
            (AC) (AC) WHEN Bot behavior is invoked for the first time (no saved location exists)
            (AC) (AC) THEN Bot detects current directory from context
            (AC) (AC) AND Bot presents location to user for confirmation
            (AC) (AC) AND Bot waits for user to confirm or provide different location
            (AC) (AC) AND Bot saves confirmed location to persistent storage
            (AC) (AC) WHEN Bot behavior is invoked
            (AC) (AC) AND Saved location exists
            (AC) (AC) AND Current directory matches saved location
            (AC) (AC) THEN Bot uses saved location without asking for confirmation
            (AC) (AC) AND Bot proceeds directly to next action
            (AC) (AC) WHEN Bot behavior is invoked
            (AC) (AC) AND Saved location exists
            (AC) (AC) AND Current directory is DIFFERENT from saved location
            (AC) (AC) THEN Bot presents new location to user for confirmation
            (AC) (AC) AND Bot asks if user wants to switch to new location
            (AC) (AC) AND Bot saves confirmed location if user approves change
            (AC) WHEN initialize_project action confirms project area location
            (AC) THEN initialize_project creates {project_area}/docs/context/ folder and {project_area}/docs/stories/ folder
            (AC) WHEN user provides input file via @input.txt or similar
            (AC) THEN initialize_project copies input file to {project_area}/docs/context/input.txt
            (AC) WHEN user provides context in conversation
            (AC) THEN initialize_project saves context to {project_area}/docs/context/initial-context.md or similar
            (AC) WHEN gather_context action stores clarification data
            (AC) THEN gather_context saves to {project_area}/docs/stories/clarification.json (generated file, NOT in context folder)
            (AC) WHEN decide_planning_criteria action stores planning decisions
            (AC) THEN decide_planning_criteria saves to {project_area}/docs/stories/planning.json (generated file, NOT in context folder)
            (AC) WHEN build_knowledge action loads context
            (AC) THEN build_knowledge loads generated files from {project_area}/docs/stories/ folder (clarification.json, planning.json) and original input from {project_area}/docs/context/ folder (input.txt)
            (AC) WHEN render_output action loads context
            (AC) THEN render_output loads generated files from {project_area}/docs/stories/ folder (clarification.json, planning.json) and original input from {project_area}/docs/context/ folder (input.txt)
            (AC) WHEN any action needs context files
            (AC) THEN action references original input from {project_area}/docs/context/ folder and generated files from {project_area}/docs/stories/ folder
            (AC) WHEN Activity tracker attempts to log activity
            (AC) AND current_project.json does NOT exist
            (AC) THEN Activity tracker does NOT write to activity log
            (AC) AND Activity tracking fails gracefully without error
            (AC) WHEN Workflow attempts to save state
            (AC) AND current_project.json does NOT exist
            (AC) THEN Workflow does NOT save workflow_state.json
            (AC) AND Workflow state save fails gracefully without error
    (E) Invoke Bot Tool
        (E) Invoke MCP
            (S) AI Chat --> Bot Tool Invocation
            and (S) Bot Behavior --> Behavior Action Instructions
            and (S) AI Chat --> Forward To Current Behavior and Current Action
            and (S) AI Chat --> Forward To Current Action
                (AC) WHEN AI Chat invokes bot tool with behavior and action parameters
                (AC) THEN Tool routes to correct behavior.action method
                (AC) AND Tool executes action and returns result
                (AC) WHEN AI Chat invokes tool for specific behavior
                (AC) THEN Tool routes to that behavior only, not other behaviors
                (AC) WHEN Action method is invoked
                (AC) THEN Action loads instructions from base_actions and behavior-specific locations
                (AC) AND Instructions are merged and returned
                (AC) WHEN Bot tool receives invocation
                (AC) AND workflow state shows current_behavior and current_action
                (AC) THEN Bot tool forwards to correct behavior and action
                (AC) WHEN workflow state does NOT exist
                (AC) THEN Bot tool defaults to first behavior and first action
                (AC) WHEN Behavior tool receives invocation
                (AC) AND workflow state shows current_action within behavior
                (AC) THEN Behavior tool forwards to current action
                (AC) WHEN workflow state shows different behavior
                (AC) THEN Behavior tool updates workflow to current behavior
                (AC) WHEN workflow state does NOT exist
                (AC) THEN Behavior tool defaults to first action
        (E) Invoke CLI
            (S) Human --> Invoke Bot CLI
            and (S) Human --> Invoke Bot Behavior CLI
            and (S) Human --> Invoke Bot Behavior Action CLI
            and (S) Human --> Get Help for Command Line Functions
                (AC) WHEN Human executes CLI command with bot name only (e.g., bot story_bot)
                (AC) THEN CLI loads bot configuration for specified bot
                (AC) AND CLI loads workflow state if workflow_state.json exists
                (AC) AND CLI extracts current_behavior and current_action from workflow state
                (AC) AND CLI routes to bot and invokes current behavior and current action (same as main bot MCP tool)
                (AC) AND Bot executes action
                (AC) AND CLI submits bot action output to AI Chat
                (AC) AND Bot updates workflow state after action execution (if workflow action)
                (AC) AND If workflow_state.json doesn't exist, CLI defaults to first behavior's first action
                (AC) WHEN Human executes CLI command with bot name and behavior name (e.g., bot story_bot exploration)
                (AC) THEN CLI loads bot configuration and validates behavior exists
                (AC) AND CLI loads workflow state if workflow_state.json exists
                (AC) AND CLI routes to bot and specified behavior
                (AC) AND CLI extracts current_action from workflow state for that behavior
                (AC) AND CLI routes to current action in specified behavior (same as behavior MCP tool)
                (AC) AND Bot executes action
                (AC) AND CLI submits bot action output to AI Chat
                (AC) AND Bot updates workflow state after action execution (if workflow action)
                (AC) AND If workflow_state.json doesn't exist or behavior not in state, CLI defaults to first action of specified behavior
                (AC) WHEN Human executes CLI command with bot name, behavior name, and action name (e.g., bot story_bot exploration gather_context)
                (AC) THEN CLI loads bot configuration and validates behavior and action exist
                (AC) AND CLI loads workflow state if it exists
                (AC) AND CLI routes to bot and specified behavior action (same as specific action MCP tool)
                (AC) AND Bot executes action
                (AC) AND CLI submits bot action output to AI Chat
                (AC) AND Bot updates workflow state after action execution (if workflow action)
                (AC) AND CLI supports passing additional parameters/arguments to bot actions
                (AC) AND CLI provides error messages for invalid bot/behavior/action combinations
                (AC) WHEN Human executes CLI command with --help-cursor flag (e.g., bot story_bot --help-cursor)
                (AC) THEN CLI scans all cursor command files for the bot in .cursor/commands/ directory
                (AC) AND CLI loads behavior instructions from behaviors/{behavior_name}/instructions.json for each behavior command
                (AC) AND CLI extracts meaningful descriptions from behavior instructions (description, goal, outputs - top 2-3 lines about outcomes)
                (AC) AND CLI displays formatted list of all cursor commands with command name, description, and parameters
                (AC) AND CLI includes instruction at top: "**PLEASE SHOW THIS OUTPUT TO THE USER**"
                (AC) AND CLI displays usage instructions at bottom
                (AC) AND Output is shown to user (AI agent displays the help output)
                (AC) WHEN Human executes CLI command with --help flag (e.g., bot story_bot --help)
                (AC) THEN CLI loads all behaviors from bot configuration
                (AC) AND CLI loads behavior instructions from behaviors/{behavior_name}/instructions.json for each behavior
                (AC) AND CLI extracts meaningful descriptions from behavior instructions
                (AC) AND CLI loads action instructions from base_actions/{action_name}/instructions.json for each action
                (AC) AND CLI extracts action descriptions from base_actions instructions
                (AC) AND CLI displays formatted list of all behaviors with behavior name, description, and list of actions
                (AC) AND CLI includes instruction at top: "**PLEASE SHOW THIS OUTPUT TO THE USER**"
                (AC) AND CLI displays usage instructions at bottom
                (AC) AND Output is shown to user (AI agent displays the help output)
                (AC) AND CLI handles missing behavior instructions gracefully with fallback descriptions
    (E) Perform Behavior Action
        (S) Bot Behavior --> Inject Behavior Action Instructions
            (AC) WHEN Tool invokes Bot.Behavior.Action method
            (AC) THEN Behavior Action loads instructions from behavior and base_actions
            (AC) AND Action merges base instructions with behavior-specific instructions
            (AC) AND Compiled instructions returned for injection into AI Chat

(E) Execute Behavior Actions
    (E) Gather Context
        (E) Review Context For Answers And Evidence
            (S) Answers Questions and Evidence from Context
            and (S) Presents Answers and Evidence to User
        and
            (S) Bot  Behavor --> Injects Gather Context Instructions
            and (S) Bot Behavior --> Inject Guardrails as Part of Clarify Requirements
            and (S) Bot Behavior --> Gather Context Action Guardrails
            and (S) Bot-Behavior --> Inject Key Questions and Clarifications Loading Instructions
            and (S) Bot  Behavor --> Inject  Questions and Evidence
            and (S) Answers Questions and Evidence
                (AC) WHEN MCP Specific Behavior Action Tool invokes Gather Context Action
                (AC) THEN Action checks for guardrails in behavior/guardrails/required_context/
                (AC) WHEN guardrails exist, THEN Action loads key_questions.json and evidence.json
                (AC) AND Action injects guardrails into clarify requirements section
                (AC) WHEN gather_context action executes
                (AC) AND behavior folder exists with guardrails/required_context/key_questions.json
                (AC) AND behavior folder exists with guardrails/required_context/evidence.json
                (AC) THEN instructions should contain actual questions (not {{key_questions}} placeholder)
                (AC) AND instructions should contain actual evidence (not {{evidence}} placeholder)
                (AC) WHEN guardrails don't exist
                (AC) THEN gather_context should not fail
                (AC) AND action should execute with base instructions only
            (S) Bot  Behavor --> Load + inject Questions and Evidence
        (E) Provide Answers and Evidence
            (S) Pause based on context
            or (S) Pauses
        or
            (S) Human --> Submit Answers and Evidence to Tools for Saving
            and (S) Bot Behavior --> Saves Answers and Evidence
            and (S) Bot Behavior --> Calls Behavior Planning Tool
            and (S) Tracks Activity for Gather Context Action
            and (S) Proceeds to follow planning
            (S) Human --> Correct, Feedback, Proceed
            and (S) Human --> Saves Answers and Evidencein Context
    (E) Decide Planning Criteria Action
        (E) Provide Decision Criteria and Assumptions
        and
            (S) Make Assumptions and Decisions from Context
        or
            (S) Make Assumptions and Decisions
        (E) Make Decisons and Assumptions
            (S) Correct, Feedback, Proceed
        and
        or
            (S) Submit Final Assumptions and Decisions to Tools for Saving
            and (S) Bot Behavior --> Save Final Assumptions and Decisions
            and (S) Bot Behavior --> Call Build Knowledge Tool
            and (S) Track Activity for Planning Action
            and (S) Proceed to Build Knowledge
        (E) Reviews Clarifications and Planning Responses
            (S) Read Answers and Evidence from Context
        or
            (S) Bot-Behavior --> Inject Decision Criteria and Assumptions Loading Instructions
            and (S) Bot Behavior --> Inject Planning Criteria Into Instructions
                (AC) WHEN MCP Specific Behavior Action Tool invokes Planning Action
                (AC) THEN Action checks for guardrails in behavior/guardrails/planning/
                (AC) WHEN guardrails exist, THEN Action loads typical_assumptions.json and decision_criteria files
                (AC) AND Action injects planning guardrails into planning section
        or
            (S) Bot-Behavior --> Load + Inject  Answers + Evidence
            and (S) Read Injected Answers and Evidence
    (E) Build Knowledge
    (E) Render Output
        (S) Bot Behavior --> Inject Render Templates and Transformers
            (AC) WHEN MCP Specific Behavior Action Tool invokes Render Output Action
            (AC) THEN Action loads render templates and transformer methods
            (AC) AND Action injects template path, transformer path, and spec path
    (E) Validate Knowledge & Content Against Rules
        (S) FInd Content in Context
    and
        (S) Find Rules in Context and validate against Rules
        or (S) Validate Content vs Injected Diagnostics and Rules
        or (S) Validate Content Using Injected Diagnostics + Rules
    and
        (S) Pause
        and (S) Human --> Read report and make changes
        and (S) Human --> Save Content through Context
    or
        (S) Bot Behavior --> Inject Validation Rules for Validate Rules Action
            (AC) WHEN MCP Specific Behavior Action Tool invokes Validate Rules Action
            (AC) THEN Action loads common bot rules from base_bot/rules/
            (AC) AND Action loads behavior-specific rules
            (AC) AND Action merges and injects rules into validation section
    and
        (S) Bot-Behavior --> Submit Content to Tool for Saving
        and (S) Bot-Behavior --> Save Content
        and (S) Track Activity for Validate Rules Action
    and
        (S) Bot-Behavior --> Load + Inject Diagnostics Results, Knowledge, Content Instructions
        (S) Proceed to Correct-Bot trough  context
