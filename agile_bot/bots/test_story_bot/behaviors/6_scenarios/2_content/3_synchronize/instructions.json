{
  "behaviorName": "specification_scenarios",
  "step": "3_synchronize",
  "instructions": [
    "**SYNCHRONIZE STORY GRAPH WITH RENDERED DOCUMENTS**",
    "",
    "**Input:** Story documents with scenarios from render step",
    "",
    "**Output:** Validation that story graph and documents are synchronized",
    "",
    "**Process:**",
    "",
    "1. **Load story graph** from project area: docs/stories/story-graph.json",
    "",
    "2. **For each story in the graph:**",
    "   - Load corresponding story document: docs/stories/{epic_name}/{sub_epic_name}/{story_name}.md",
    "   - Extract scenarios from document",
    "   - Compare with scenarios in story graph",
    "",
    "3. **Validate synchronization:**",
    "   - All scenarios in graph exist in document",
    "   - All scenarios in document exist in graph",
    "   - Scenario names, types, and steps match",
    "   - Background steps match (if applicable)",
    "",
    "4. **Generate sync report:**",
    "   - List any discrepancies found",
    "   - Indicate missing or extra scenarios",
    "   - Show differences in scenario content",
    "",
    "5. **If discrepancies found:**",
    "   - Present sync report to user",
    "   - Ask user to confirm resolution strategy:",
    "     * Update graph from documents (if documents were manually edited)",
    "     * Update documents from graph (if graph is source of truth)",
    "     * Manual resolution required",
    "",
    "6. **Apply synchronization:**",
    "   - Update story graph and/or documents as needed",
    "   - Save updated files to project area",
    "",
    "**Validation:**",
    "- Story graph and documents are fully synchronized",
    "- No orphaned scenarios in either graph or documents",
    "- All scenario content matches exactly"
  ]
}


