name: Test Detection Logic

on:
  push:
    branches: [ main ]
    paths: [ 'features/**', '.github/workflows/test-detection.yml' ]
  workflow_dispatch:

jobs:
  test-detection:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Test detection logic
      run: |
        echo "ğŸ§ª Testing feature detection..."
        echo ""
        
        # Simulate changed files
        CHANGED_FILES="features/test-feature/main.py"
        
        echo "ğŸ“„ Changed files: $CHANGED_FILES"
        
        # Extract feature names
        FEATURES=$(echo "$CHANGED_FILES" | grep '^features/[^/]*/' | grep -v '^features/containerization/' | cut -d'/' -f2 | sort -u | grep -v "^$" | tr '\n' ' ')
        
        echo "ğŸ“‹ Detected features: '$FEATURES'"
        
        if [ -z "$FEATURES" ]; then
          echo "âŒ No features detected!"
          exit 1
        else
          echo "âœ… Features detected: $FEATURES"
        fi

